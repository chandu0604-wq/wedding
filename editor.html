<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Wedding Invitation Editor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: radial-gradient(
          circle at top,
          #fde7f2 0,
          #f8f3ff 30%,
          #faf7f5 60%,
          #f3f3f3 100%
        );
        color: #222;
        min-height: 100vh;
        display: flex;
      }
      #root {
        flex: 1;
        display: flex;
      }
      .app {
        display: flex;
        flex: 1;
        min-height: 100vh;
      }
      .panel {
        width: 360px;
        max-width: 100%;
        padding: 16px 14px;
        border-right: 1px solid #e4d7ea;
        background: #ffffffe6;
        backdrop-filter: blur(12px);
        box-shadow: 0 0 24px rgba(0, 0, 0, 0.05);
        position: sticky;
        top: 0;
        align-self: flex-start;
        height: 100vh;
        overflow-y: auto;
      }
      .panel-title {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 4px;
      }
      .panel-sub {
        font-size: 0.8rem;
        color: #777;
        margin-bottom: 10px;
      }
      .badge {
        display: inline-block;
        font-size: 0.7rem;
        padding: 3px 8px;
        border-radius: 999px;
        background: #f4e4ff;
        color: #6b3f93;
        margin-left: 4px;
      }
      .field {
        margin-bottom: 10px;
        font-size: 0.8rem;
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .field label {
        font-weight: 500;
      }
      .field input,
      .field textarea {
        border-radius: 8px;
        border: 1px solid #d7cadf;
        padding: 6px 8px;
        font-size: 0.8rem;
        background: #fbf8ff;
        outline: none;
        transition: border 0.15s, box-shadow 0.15s, transform 0.1s;
      }
      .field input:focus,
      .field textarea:focus {
        border-color: #c47b9b;
        box-shadow: 0 0 0 1px #c47b9b33;
        transform: translateY(-1px);
      }
      .hint {
        font-size: 0.72rem;
        color: #777;
      }
      .divider {
        border: none;
        border-top: 1px dashed #e0d2eb;
        margin: 10px 0;
      }

      .upload-card {
        margin-top: 4px;
        border-radius: 14px;
        border: 1px dashed #d5c4ec;
        background: radial-gradient(circle at top left, #fdf4ff 0, #ffffff 40%);
        padding: 10px;
        cursor: pointer;
        overflow: hidden;
        position: relative;
        transition: box-shadow 0.2s, transform 0.1s, border-color 0.2s;
      }
      .upload-card:hover {
        box-shadow: 0 10px 26px rgba(91, 36, 122, 0.18);
        transform: translateY(-1px);
        border-color: #c47b9b;
      }
      .upload-card.drag-over {
        border-style: solid;
        border-color: #c47b9b;
        box-shadow: 0 0 0 2px #c47b9b44;
      }
      .upload-inner {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .upload-icon-wrap {
        width: 34px;
        height: 34px;
        border-radius: 999px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f9e3ff;
        animation: floatIcon 2s ease-in-out infinite;
      }
      .upload-icon {
        font-size: 18px;
      }
      .upload-text-main {
        font-size: 0.8rem;
        font-weight: 500;
      }
      .upload-text-sub {
        font-size: 0.7rem;
        color: #777;
      }
      .upload-pill {
        font-size: 0.65rem;
        padding: 2px 8px;
        border-radius: 999px;
        border: 1px solid #e2d3ff;
        background: #faf7ff;
        margin-left: auto;
        white-space: nowrap;
      }
      .upload-hidden-input {
        display: none;
      }
      @keyframes floatIcon {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-4px);
        }
      }

      .main {
        flex: 1;
        padding: 24px 18px;
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      .preview-card {
        max-width: 640px;
        margin: 0 auto;
        border-radius: 24px;
        overflow: hidden;
        box-shadow: 0 18px 40px rgba(18, 8, 41, 0.4);
        position: relative;
      }
      .preview-bg {
        position: absolute;
        inset: 0;
        z-index: -2;
      }
      .preview-bg img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: brightness(0.35) saturate(1.2);
        transform: scale(1.02);
      }
      .preview-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(
          to bottom,
          rgba(0, 0, 0, 0.4),
          rgba(0, 0, 0, 0.9)
        );
        z-index: -1;
      }
      .preview-content {
        padding: 60px 22px 40px;
        text-align: center;
        color: #fff;
      }
      .pill {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 6px 14px;
        border-radius: 999px;
        border: 1px solid #ffffff55;
        background: #ffffff15;
        backdrop-filter: blur(6px);
        font-size: 0.8rem;
      }
      .preview-title {
        font-size: 2.3rem;
        margin: 12px 0 4px;
        letter-spacing: 2px;
      }
      .preview-sub {
        font-size: 0.95rem;
        opacity: 0.9;
      }
      .preview-text {
        margin-top: 10px;
        font-size: 0.85rem;
        max-width: 520px;
        margin-left: auto;
        margin-right: auto;
        opacity: 0.9;
      }
      .invite-box {
        margin-top: 6px;
        padding: 10px;
        border-radius: 14px;
        background: #fbf8ff;
        border: 1px solid #e0d2f0;
        font-size: 0.78rem;
        word-break: break-all;
      }
      .row {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 8px;
      }
      .btn {
        padding: 8px 14px;
        border-radius: 999px;
        border: none;
        font-size: 0.8rem;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: #c47b9b;
        color: #fff;
        box-shadow: 0 10px 24px rgba(196, 123, 155, 0.7);
        transition: transform 0.1s, box-shadow 0.1s;
      }
      .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 13px 30px rgba(196, 123, 155, 0.85);
      }
      .btn-outline {
        padding: 8px 14px;
        border-radius: 999px;
        font-size: 0.8rem;
        cursor: pointer;
        border: 1px solid #dac5f0;
        background: #fff;
      }

      .music-preview {
        margin-top: 8px;
        background: #fff;
        border-radius: 14px;
        padding: 10px;
        box-shadow: 0 10px 24px rgba(26, 9, 53, 0.12);
      }
      .music-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 8px;
      }
      .music-label-main {
        font-size: 0.8rem;
        font-weight: 500;
      }
      .music-label-sub {
        font-size: 0.7rem;
        color: #777;
      }
      .music-pill {
        font-size: 0.7rem;
        padding: 2px 8px;
        border-radius: 999px;
        background: #f4e0ff;
        color: #7a429e;
      }

      @media (max-width: 880px) {
        body {
          flex-direction: column;
        }
        .app {
          flex-direction: column;
        }
        .panel {
          position: static;
          width: 100%;
          height: auto;
          border-right: none;
          border-bottom: 1px solid #e4d7ea;
        }
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const { useState, useMemo } = React;

      function originUrl() {
        return window.location.origin;
      }

      function buildInviteUrl({
        bride,
        groom,
        date,
        location,
        welcome,
        theme,
        phone,
        heroImage,
      }) {
        const base = originUrl() + "/invite.html";
        const params = new URLSearchParams();
        params.set("bride", bride);
        params.set("groom", groom);
        if (date) params.set("date", date);
        if (location) params.set("location", location);
        if (welcome) params.set("welcome", welcome);
        if (theme) params.set("theme", theme);
        if (phone) params.set("phone", phone);
        if (heroImage) params.set("heroImage", heroImage);
        return `${base}?${params.toString()}`;
      }

      function shareText(bride, groom, location, inviteUrl) {
        return `You are invited to the wedding of ${bride} & ${groom}${
          location ? " at " + location : ""
        }. Tap to view the full invitation: ${inviteUrl}`;
      }

      function EditorApp() {
        const [bride, setBride] = useState("Aaradhya");
        const [groom, setGroom] = useState("Shreyas");
        const [date, setDate] = useState("");
        const [location, setLocation] = useState("Bangalore, India");
        const [welcome, setWelcome] = useState(
          "We are delighted to invite you to celebrate our special day with us."
        );
        const [theme, setTheme] = useState("#c47b9b");
        const [heroImageUrl, setHeroImageUrl] = useState(
          "https://images.pexels.com/photos/1444442/pexels-photo-1444442.jpeg"
        );
        const [phone, setPhone] = useState("919019823918");

        // Local previews (from uploads)
        const [heroPreview, setHeroPreview] = useState(null);
        const [musicPreview, setMusicPreview] = useState(null);

        const inviteUrl = useMemo(
          () =>
            buildInviteUrl({
              bride,
              groom,
              date,
              location,
              welcome,
              theme,
              phone,
              heroImage: heroImageUrl,
            }),
          [bride, groom, date, location, welcome, theme, phone, heroImageUrl]
        );

        function handleCopy() {
          navigator.clipboard
            .writeText(inviteUrl)
            .then(() => alert("Invite link copied!"))
            .catch(() => alert("Copy failed, please copy manually."));
        }

        function handleOpenInvite() {
          window.open(inviteUrl, "_blank");
        }

        function handleShareWhatsApp() {
          const text = shareText(bride, groom, location, inviteUrl);
          window.open(
            `https://wa.me/?text=${encodeURIComponent(text)}`,
            "_blank"
          );
        }

        function handleShareTelegram() {
          const text = shareText(bride, groom, location, inviteUrl);
          window.open(
            `https://t.me/share/url?url=${encodeURIComponent(
              inviteUrl
            )}&text=${encodeURIComponent(text)}`,
            "_blank"
          );
        }

        const displayDate = date
          ? new Date(date).toLocaleDateString(undefined, {
              weekday: "long",
              year: "numeric",
              month: "long",
              day: "numeric",
            })
          : "Our Wedding Day";

        // ----- drag & drop helpers -----
        function makeUploadHandlers(onFile) {
          let over = false;
          const handleDrop = (e) => {
            e.preventDefault();
            e.stopPropagation();
            over = false;
            e.currentTarget.classList.remove("drag-over");
            const file = e.dataTransfer.files?.[0];
            if (file) onFile(file);
          };
          const handleDragOver = (e) => {
            e.preventDefault();
            e.stopPropagation();
            if (!over) {
              over = true;
              e.currentTarget.classList.add("drag-over");
            }
          };
          const handleDragLeave = (e) => {
            e.preventDefault();
            e.stopPropagation();
            over = false;
            e.currentTarget.classList.remove("drag-over");
          };
          return { handleDrop, handleDragOver, handleDragLeave };
        }

        function handleHeroFile(file) {
          if (!file.type.startsWith("image/")) {
            alert("Please upload an image file.");
            return;
          }
          const url = URL.createObjectURL(file);
          setHeroPreview(url);
        }

        function handleMusicFile(file) {
          if (!file.type.startsWith("audio/")) {
            alert("Please upload an audio file (MP3/WAV).");
            return;
          }
          const url = URL.createObjectURL(file);
          setMusicPreview(url);
        }

        const heroUploadHandlers = makeUploadHandlers(handleHeroFile);
        const musicUploadHandlers = makeUploadHandlers(handleMusicFile);

        return (
          <div className="app">
            <aside className="panel">
              <div className="panel-title">
                Wedding Editor <span className="badge">/invite.html</span>
              </div>
              <div className="panel-sub">
                Customize the invitation, then share the generated link. Guests
                will only see the invite page.
              </div>

              <div className="field">
                <label>Bride name</label>
                <input
                  value={bride}
                  onChange={(e) => setBride(e.target.value)}
                />
              </div>

              <div className="field">
                <label>Groom name</label>
                <input
                  value={groom}
                  onChange={(e) => setGroom(e.target.value)}
                />
              </div>

              <div className="field">
                <label>Wedding date</label>
                <input
                  type="date"
                  value={date}
                  onChange={(e) => setDate(e.target.value)}
                />
              </div>

              <div className="field">
                <label>Location</label>
                <input
                  value={location}
                  onChange={(e) => setLocation(e.target.value)}
                />
              </div>

              <div className="field">
                <label>Welcome message</label>
                <textarea
                  rows={3}
                  value={welcome}
                  onChange={(e) => setWelcome(e.target.value)}
                />
              </div>

              <div className="field">
                <label>Theme color</label>
                <input
                  type="color"
                  value={theme}
                  onChange={(e) => setTheme(e.target.value)}
                />
              </div>

              <hr className="divider" />

              {/* HERO UPLOAD */}
              <div className="field">
                <label>Hero photo (preview upload)</label>
                <div
                  className="upload-card"
                  onClick={() =>
                    document.getElementById("heroUploadInput").click()
                  }
                  onDrop={heroUploadHandlers.handleDrop}
                  onDragOver={heroUploadHandlers.handleDragOver}
                  onDragLeave={heroUploadHandlers.handleDragLeave}
                >
                  <div className="upload-inner">
                    <div className="upload-icon-wrap">
                      <span className="upload-icon">üì∑</span>
                    </div>
                    <div>
                      <div className="upload-text-main">
                        Drag & drop or click to choose
                      </div>
                      <div className="upload-text-sub">
                        Only for your live preview and screenshots.
                      </div>
                    </div>
                    <div className="upload-pill">Local preview</div>
                  </div>
                </div>
                <input
                  id="heroUploadInput"
                  type="file"
                  accept="image/*"
                  className="upload-hidden-input"
                  onChange={(e) => {
                    const file = e.target.files?.[0];
                    if (file) handleHeroFile(file);
                  }}
                />
                <span className="hint">
                  For guests, use a public link below (Pexels, Drive, etc.).
                </span>
              </div>

              <div className="field">
                <label>Hero image URL (used for guests)</label>
                <input
                  value={heroImageUrl}
                  onChange={(e) => setHeroImageUrl(e.target.value)}
                  placeholder="https://..."
                />
                <span className="hint">
                  This URL is stored inside the invite link and is what guests
                  will see.
                </span>
              </div>

              <hr className="divider" />

              {/* MUSIC UPLOAD */}
              <div className="field">
                <label>Background music (preview upload)</label>
                <div
                  className="upload-card"
                  onClick={() =>
                    document.getElementById("musicUploadInput").click()
                  }
                  onDrop={musicUploadHandlers.handleDrop}
                  onDragOver={musicUploadHandlers.handleDragOver}
                  onDragLeave={musicUploadHandlers.handleDragLeave}
                >
                  <div className="upload-inner">
                    <div className="upload-icon-wrap">
                      <span className="upload-icon">üéµ</span>
                    </div>
                    <div>
                      <div className="upload-text-main">
                        Drag & drop or click to add music
                      </div>
                      <div className="upload-text-sub">
                        Plays only in your editor preview (guests still hear
                        default track).
                      </div>
                    </div>
                    <div className="upload-pill">Audio preview</div>
                  </div>
                </div>
                <input
                  id="musicUploadInput"
                  type="file"
                  accept="audio/*"
                  className="upload-hidden-input"
                  onChange={(e) => {
                    const file = e.target.files?.[0];
                    if (file) handleMusicFile(file);
                  }}
                />
              </div>

              <div className="music-preview">
                <div className="music-row">
                  <div>
                    <div className="music-label-main">Preview music</div>
                    <div className="music-label-sub">
                      If none uploaded, a default soft track is used.
                    </div>
                  </div>
                  <div className="music-pill">live only</div>
                </div>
                <audio
                  controls
                  loop
                  style={{ width: "100%", marginTop: "6px" }}
                  src={
                    musicPreview ||
                    "https://cdn.pixabay.com/audio/2021/09/30/audio_b4b5c1c8b4.mp3"
                  }
                />
              </div>

              <hr className="divider" />

              <div className="field">
                <label>RSVP WhatsApp number</label>
                <input
                  value={phone}
                  onChange={(e) =>
                    setPhone(e.target.value.replace(/\s+/g, ""))
                  }
                  placeholder="e.g. 919876543210"
                />
                <span className="hint">
                  Any number is allowed. Include country code, no + or spaces.
                </span>
              </div>

              <hr className="divider" />

              <div className="field">
                <label>Generated invite link (share this)</label>
                <div className="invite-box">{inviteUrl}</div>
                <div className="row">
                  <button className="btn" onClick={handleCopy}>
                    üìã Copy link
                  </button>
                  <button className="btn-outline" onClick={handleOpenInvite}>
                    üîç Open invite
                  </button>
                </div>
              </div>

              <div className="field">
                <label>Quick share</label>
                <div className="row">
                  <button className="btn-outline" onClick={handleShareWhatsApp}>
                    üü¢ WhatsApp
                  </button>
                  <button className="btn-outline" onClick={handleShareTelegram}>
                    üì® Telegram
                  </button>
                </div>
                <span className="hint">
                  These share the invite link. Guests tap ‚Üí your /invite.html
                  card opens.
                </span>
              </div>
            </aside>

            <main className="main">
              <h2>Live Invitation Preview</h2>
              <p style={{ fontSize: "0.82rem", color: "#666", marginTop: 4 }}>
                This mirrors what guests see on /invite.html (hero/photo +
                text). Local uploads change this preview only.
              </p>
              <div className="preview-card">
                <div className="preview-bg">
                  <img
                    src={heroPreview || heroImageUrl}
                    alt="Preview"
                    onError={(e) => {
                      e.target.src =
                        "https://images.pexels.com/photos/1444442/pexels-photo-1444442.jpeg";
                    }}
                  />
                </div>
                <div className="preview-overlay" />
                <div className="preview-content">
                  <div className="pill">
                    <span>{displayDate}</span>
                    <span>‚Ä¢</span>
                    <span>{location}</span>
                  </div>
                  <div className="preview-title">
                    {bride} &amp; {groom}
                  </div>
                  <div className="preview-sub">You are invited to celebrate.</div>
                  <p className="preview-text">{welcome}</p>
                </div>
              </div>
            </main>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<EditorApp />);
    </script>
  </body>
</html>
